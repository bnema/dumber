// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: favorite_tags.sql

package db

import (
	"context"
)

const AssignTag = `-- name: AssignTag :exec
INSERT OR IGNORE INTO favorite_tag_assignments (favorite_id, tag_id) VALUES (?, ?)
`

func (q *Queries) AssignTag(ctx context.Context, favoriteID int64, tagID int64) error {
	_, err := q.db.ExecContext(ctx, AssignTag, favoriteID, tagID)
	return err
}

const ClearTagsFromFavorite = `-- name: ClearTagsFromFavorite :exec
DELETE FROM favorite_tag_assignments WHERE favorite_id = ?
`

func (q *Queries) ClearTagsFromFavorite(ctx context.Context, favoriteID int64) error {
	_, err := q.db.ExecContext(ctx, ClearTagsFromFavorite, favoriteID)
	return err
}

const CreateTag = `-- name: CreateTag :one
INSERT INTO favorite_tags (name, color) VALUES (?, ?) RETURNING id, name, color, created_at
`

func (q *Queries) CreateTag(ctx context.Context, name string, color string) (FavoriteTag, error) {
	row := q.db.QueryRowContext(ctx, CreateTag, name, color)
	var i FavoriteTag
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Color,
		&i.CreatedAt,
	)
	return i, err
}

const DeleteTag = `-- name: DeleteTag :exec
DELETE FROM favorite_tags WHERE id = ?
`

func (q *Queries) DeleteTag(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, DeleteTag, id)
	return err
}

const GetAllTags = `-- name: GetAllTags :many

SELECT id, name, color, created_at FROM favorite_tags ORDER BY name ASC
`

// Favorite tags CRUD and assignment operations
func (q *Queries) GetAllTags(ctx context.Context) ([]FavoriteTag, error) {
	rows, err := q.db.QueryContext(ctx, GetAllTags)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []FavoriteTag{}
	for rows.Next() {
		var i FavoriteTag
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Color,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const GetFavoritesWithTag = `-- name: GetFavoritesWithTag :many
SELECT f.id, f.url, f.title, f.favicon_url, f.position, f.created_at, f.updated_at, f.folder_id, f.shortcut_key FROM favorites f INNER JOIN favorite_tag_assignments fta ON f.id = fta.favorite_id WHERE fta.tag_id = ? ORDER BY f.position ASC
`

func (q *Queries) GetFavoritesWithTag(ctx context.Context, tagID int64) ([]Favorite, error) {
	rows, err := q.db.QueryContext(ctx, GetFavoritesWithTag, tagID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Favorite{}
	for rows.Next() {
		var i Favorite
		if err := rows.Scan(
			&i.ID,
			&i.Url,
			&i.Title,
			&i.FaviconUrl,
			&i.Position,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.FolderID,
			&i.ShortcutKey,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const GetTagByID = `-- name: GetTagByID :one
SELECT id, name, color, created_at FROM favorite_tags WHERE id = ? LIMIT 1
`

func (q *Queries) GetTagByID(ctx context.Context, id int64) (FavoriteTag, error) {
	row := q.db.QueryRowContext(ctx, GetTagByID, id)
	var i FavoriteTag
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Color,
		&i.CreatedAt,
	)
	return i, err
}

const GetTagByName = `-- name: GetTagByName :one
SELECT id, name, color, created_at FROM favorite_tags WHERE name = ? LIMIT 1
`

func (q *Queries) GetTagByName(ctx context.Context, name string) (FavoriteTag, error) {
	row := q.db.QueryRowContext(ctx, GetTagByName, name)
	var i FavoriteTag
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Color,
		&i.CreatedAt,
	)
	return i, err
}

const GetTagCount = `-- name: GetTagCount :one
SELECT COUNT(*) as count FROM favorite_tags
`

func (q *Queries) GetTagCount(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, GetTagCount)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const GetTagUsageCount = `-- name: GetTagUsageCount :one
SELECT COUNT(*) as count FROM favorite_tag_assignments WHERE tag_id = ?
`

func (q *Queries) GetTagUsageCount(ctx context.Context, tagID int64) (int64, error) {
	row := q.db.QueryRowContext(ctx, GetTagUsageCount, tagID)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const GetTagsForFavorite = `-- name: GetTagsForFavorite :many
SELECT t.id, t.name, t.color, t.created_at FROM favorite_tags t INNER JOIN favorite_tag_assignments fta ON t.id = fta.tag_id WHERE fta.favorite_id = ? ORDER BY t.name ASC
`

func (q *Queries) GetTagsForFavorite(ctx context.Context, favoriteID int64) ([]FavoriteTag, error) {
	rows, err := q.db.QueryContext(ctx, GetTagsForFavorite, favoriteID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []FavoriteTag{}
	for rows.Next() {
		var i FavoriteTag
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Color,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const RemoveTag = `-- name: RemoveTag :exec
DELETE FROM favorite_tag_assignments WHERE favorite_id = ? AND tag_id = ?
`

func (q *Queries) RemoveTag(ctx context.Context, favoriteID int64, tagID int64) error {
	_, err := q.db.ExecContext(ctx, RemoveTag, favoriteID, tagID)
	return err
}

const UpdateTag = `-- name: UpdateTag :exec
UPDATE favorite_tags SET name = ?, color = ? WHERE id = ?
`

func (q *Queries) UpdateTag(ctx context.Context, name string, color string, iD int64) error {
	_, err := q.db.ExecContext(ctx, UpdateTag, name, color, iD)
	return err
}
